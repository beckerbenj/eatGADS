<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>`createGADS`: Creating a relational data base • eatGADS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`createGADS`: Creating a relational data base">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eatGADS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/createGADS.html">`createGADS`: Creating a relational data base</a></li>
    <li><a class="dropdown-item" href="../articles/data_cleaning.html">Comprehensive Data Cleaning Guide</a></li>
    <li><a class="dropdown-item" href="../articles/getGADS.html">`getGADS`: Using a relational eatGADS data base</a></li>
    <li><a class="dropdown-item" href="../articles/import_raw.html">Handling meta data</a></li>
    <li><a class="dropdown-item" href="../articles/import_spss.html">`import_spss`: Importing data from 'SPSS'</a></li>
    <li><a class="dropdown-item" href="../articles/recoding_forcedChoice.html">Recoding a forced choice item with a text field</a></li>
    <li><a class="dropdown-item" href="../articles/recoding_multipleChoice.html">Recoding a multiple choice item with a text field</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/beckerbenj/eatGADS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>`createGADS`: Creating a relational data base</h1>
                        <h4 data-toc-skip class="author">Benjamin
Becker</h4>
            
            <h4 data-toc-skip class="date">2025-02-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/beckerbenj/eatGADS/blob/master/vignettes/createGADS.Rmd" class="external-link"><code>vignettes/createGADS.Rmd</code></a></small>
      <div class="d-none name"><code>createGADS.Rmd</code></div>
    </div>

    
    
<p>In the context of educational large-scale assessments (but also in
other contexts) we frequently encounter data sets which have an
hierarchical structure. In educational large-scale assessments these
can, for example, be pupils nested in schools. Additional, hidden nested
structures occur, if missing data are treated with multiple imputations
or person parameters are estimated using plausible values. In these
cases it is inefficient to store all the data in one rectangular data
set. In other data science applications the use of relational data bases
is a widespread measure to tackle this challenge.</p>
<p><code>eatGADS</code> supports creating such relational data bases
(based on the open source software <code>SQLite3</code> and the
<code>R</code> package <code>eatDB</code>) while maintaining its meta
data and providing a very user friendly interface for data users who are
unfamiliar with relational data bases. In doing so, it allows the
handling of large data sets even on limited hardware settings.
Furthermore, this approach allows the extraction of data from different
hierarchy levels, which means that data has to be reshaped very
rarely.</p>
<p>This vignette illustrates how a relational <code>eatGADS</code> data
base can be created from a rectangular <code>SPSS</code>
(<code>.sav</code>) data file. For illustrative purposes we use a small
example data set from the campus files of the German PISA Plus
assessment. The complete campus files and the original data set can be
accessed <a href="https://www.iqb.hu-berlin.de/fdz/Datenzugang/CF-Antrag/AntragsformularCF" class="external-link">here</a>
and <a href="https://www.iqb.hu-berlin.de/fdz/Datenzugang/SUF-Antrag" class="external-link">here</a>.</p>
<div class="section level2">
<h2 id="importing-data">Importing data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/beckerbenj/eatGADS" class="external-link">eatGADS</a></span><span class="op">)</span></span></code></pre></div>
<p>We can import an <code>.sav</code> (or an compressed
<code>.zsav</code>) data set via the <code><a href="../reference/import_spss.html">import_spss()</a></code>
function. Checks on variable names for <code>SQLite3</code> compliance
are performed automatically. Changes to the variable names are reported
to the console.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sav_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pisa.zsav"</span>, package <span class="op">=</span> <span class="st">"eatGADS"</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_spss.html">import_spss</a></span><span class="op">(</span><span class="va">sav_path</span><span class="op">)</span></span></code></pre></div>
<p>The next steps depend on the data structure: If the different
hierarchy levels are saved in different source data sets (e.g. different
<code>.sav</code> files) the next section can be skipped. However,
sometimes data from different hierarchy levels is saved in one data
file. Then, splitting and reshaping becomes necessary.</p>
</div>
<div class="section level2">
<h2 id="splitting-and-reshaping">Splitting and Reshaping<a class="anchor" aria-label="anchor" href="#splitting-and-reshaping"></a>
</h2>
<p>In this case, we want to split the imported <code>GADSdat</code>
object into its hierarchy levels (in our example: background data on
level 1 and imputed competence data on level 2). This can be achieved by
the <code><a href="../reference/splitGADS.html">splitGADS()</a></code> function. We specify the hierarchical
structure as a <code>list</code>. After this, we can extract separate
<code>GADSdat</code> objects by name via the <code>extractGADS()</code>
function. These objects can then be used for reshaping.</p>
<p>For reasons of simplicity, the example only contains two hierarchy
levels. In practice, often more hierarchy levels are present. Splitting
can be performed into as many hierarchy levels as desired. The reshaping
has to be performed for each hierarchy level separately.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"pv"</span>, <span class="fu"><a href="../reference/namesGADS.html">namesGADS</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">splitted_gads</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splitGADS.html">splitGADS</a></span><span class="op">(</span><span class="va">dat</span>, nameList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>noImp <span class="op">=</span> <span class="fu"><a href="../reference/namesGADS.html">namesGADS</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="../reference/namesGADS.html">namesGADS</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pvs</span><span class="op">]</span>,</span>
<span>                    PVs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"idstud"</span>, <span class="va">pvs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># new Structure</span></span>
<span><span class="fu"><a href="../reference/namesGADS.html">namesGADS</a></span><span class="op">(</span><span class="va">splitted_gads</span><span class="op">)</span></span>
<span><span class="co">#&gt; $noImp</span></span>
<span><span class="co">#&gt;   [1] "idstud"       "idschool"     "idclass"      "schtype"      "sameteach"   </span></span>
<span><span class="co">#&gt;   [6] "g8g9"         "ganztag"      "classsize"    "repeated"     "gender"      </span></span>
<span><span class="co">#&gt;  [11] "age"          "language"     "migration"    "hisced"       "hisei"       </span></span>
<span><span class="co">#&gt;  [16] "homepos"      "books"        "pared"        "computer_age" "internet_age"</span></span>
<span><span class="co">#&gt;  [21] "int_use_a"    "int_use_b"    "truancy_a"    "truancy_b"    "truancy_c"   </span></span>
<span><span class="co">#&gt;  [26] "int_a"        "int_b"        "int_c"        "int_d"        "instmot_a"   </span></span>
<span><span class="co">#&gt;  [31] "instmot_b"    "instmot_c"    "instmot_d"    "norms_a"      "norms_b"     </span></span>
<span><span class="co">#&gt;  [36] "norms_c"      "norms_d"      "norms_e"      "norms_f"      "anxiety_a"   </span></span>
<span><span class="co">#&gt;  [41] "anxiety_b"    "anxiety_c"    "anxiety_d"    "anxiety_e"    "selfcon_a"   </span></span>
<span><span class="co">#&gt;  [46] "selfcon_b"    "selfcon_c"    "selfcon_d"    "selfcon_e"    "worketh_a"   </span></span>
<span><span class="co">#&gt;  [51] "worketh_b"    "worketh_c"    "worketh_d"    "worketh_e"    "worketh_f"   </span></span>
<span><span class="co">#&gt;  [56] "worketh_g"    "worketh_h"    "worketh_i"    "intent_a"     "intent_b"    </span></span>
<span><span class="co">#&gt;  [61] "intent_c"     "intent_d"     "intent_e"     "behav_a"      "behav_b"     </span></span>
<span><span class="co">#&gt;  [66] "behav_c"      "behav_d"      "behav_e"      "behav_f"      "behav_g"     </span></span>
<span><span class="co">#&gt;  [71] "behav_h"      "teach_a"      "teach_b"      "teach_c"      "teach_d"     </span></span>
<span><span class="co">#&gt;  [76] "teach_e"      "cognact_a"    "cognact_b"    "cognact_c"    "cognact_d"   </span></span>
<span><span class="co">#&gt;  [81] "cognact_e"    "cognact_f"    "cognact_g"    "cognact_h"    "cognact_i"   </span></span>
<span><span class="co">#&gt;  [86] "discpline_a"  "discpline_b"  "discpline_c"  "discpline_d"  "discpline_e" </span></span>
<span><span class="co">#&gt;  [91] "relation_a"   "relation_b"   "relation_c"   "relation_d"   "relation_e"  </span></span>
<span><span class="co">#&gt;  [96] "belong_a"     "belong_b"     "belong_c"     "belong_d"     "belong_e"    </span></span>
<span><span class="co">#&gt; [101] "belong_f"     "belong_g"     "belong_h"     "belong_i"     "attitud_a"   </span></span>
<span><span class="co">#&gt; [106] "attitud_b"    "attitud_c"    "attitud_d"    "attitud_e"    "attitud_f"   </span></span>
<span><span class="co">#&gt; [111] "attitud_g"    "attitud_h"    "grade_de"     "grade_ma"     "grade_bio"   </span></span>
<span><span class="co">#&gt; [116] "grade_che"    "grade_phy"    "grade_sci"   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $PVs</span></span>
<span><span class="co">#&gt;  [1] "idstud"  "ma_pv1"  "ma_pv2"  "ma_pv3"  "ma_pv4"  "ma_pv5"  "rea_pv1"</span></span>
<span><span class="co">#&gt;  [8] "rea_pv2" "rea_pv3" "rea_pv4" "rea_pv5" "sci_pv1" "sci_pv2" "sci_pv3"</span></span>
<span><span class="co">#&gt; [15] "sci_pv4" "sci_pv5"</span></span>
<span></span>
<span><span class="co"># Extract GADSdat objects</span></span>
<span><span class="va">noImp_gads</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extractGADSdat.html">extractGADSdat</a></span><span class="op">(</span><span class="va">splitted_gads</span>, <span class="st">"noImp"</span><span class="op">)</span></span>
<span><span class="va">pvs_gads</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extractGADSdat.html">extractGADSdat</a></span><span class="op">(</span><span class="va">splitted_gads</span>, <span class="st">"PVs"</span><span class="op">)</span></span></code></pre></div>
<p>For reshaping data we highly recommend the <code>R</code> package
<code>tidyr</code>. Its performance might be less optimized than for
example the <code>data.table</code> package, however it is very
intuitive and user friendly. For our example data set we need to reshape
the <code>PVs</code> from wide to long format and then separate the
resulting column into two columns, containing the <code>dimension</code>
and imputation number (<code>imp</code>) (Note: This results in a data
set in which different dimensions for a single student are stored in
separate rows, not columns). For this, we directly access the data in
the <code>GADSdat</code> object via <code>pvs_gads$dat</code>. The
reshaping is performed by <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">tidyr::pivot_longer()</a></code>.
<code><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">tidyr::separate()</a></code> is used to separate our two additional
identifier columns (<code>dimension</code> and <code>imp</code>).
Finally, we clean the <code>imp</code> column and transform it to
numeric.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract raw data from pv gads</span></span>
<span><span class="va">pvs_wide</span> <span class="op">&lt;-</span> <span class="va">pvs_gads</span><span class="op">$</span><span class="va">dat</span></span>
<span></span>
<span><span class="co"># Wide format</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pvs_wide</span><span class="op">)</span></span>
<span><span class="co">#&gt;   idstud     ma_pv1     ma_pv2     ma_pv3      ma_pv4     ma_pv5    rea_pv1</span></span>
<span><span class="co">#&gt; 1      1  0.1537201 -0.0411933  0.5702895  0.01687233  0.3003968  0.4391437</span></span>
<span><span class="co">#&gt; 2      2 -0.3690980 -0.1201779 -0.2164011 -0.64099562 -0.3626861 -0.3471025</span></span>
<span><span class="co">#&gt; 3      3  1.7042239  2.2205527  1.7162633  2.78119427  2.6928097  0.8667544</span></span>
<span><span class="co">#&gt; 4      4  0.3490264  0.6069737  1.0037767  0.67002173  0.8012499 -0.7661811</span></span>
<span><span class="co">#&gt; 5      5 -0.6379547 -0.8142668 -0.6153099 -0.38015661 -0.1363339  0.1145925</span></span>
<span><span class="co">#&gt; 6      6 -1.5558856 -2.0435904 -0.7931236 -1.26866066 -1.1869012 -1.0732799</span></span>
<span><span class="co">#&gt;       rea_pv2     rea_pv3     rea_pv4    rea_pv5    sci_pv1    sci_pv2</span></span>
<span><span class="co">#&gt; 1  0.01991714  1.42848870 -0.06243637  0.8371030  0.1317762  0.6783006</span></span>
<span><span class="co">#&gt; 2  0.09553654  0.49335276  0.10951613  0.6657507 -0.8650453 -0.3834589</span></span>
<span><span class="co">#&gt; 3  0.61768689  1.17497378  1.12938438  1.3001419  1.1035166  1.2730882</span></span>
<span><span class="co">#&gt; 4  0.80961068  0.09573558 -0.23817788  0.2853083 -0.3049963  0.2290473</span></span>
<span><span class="co">#&gt; 5 -0.08762244  0.06418227  0.57376133 -0.5326255 -0.8032184 -0.6878142</span></span>
<span><span class="co">#&gt; 6 -1.18496034 -0.67843740 -0.06669544 -0.5332718 -0.9191711 -1.6379850</span></span>
<span><span class="co">#&gt;       sci_pv3     sci_pv4    sci_pv5</span></span>
<span><span class="co">#&gt; 1  1.46203909  0.61406429  0.4807234</span></span>
<span><span class="co">#&gt; 2 -0.54372393 -1.00303484 -0.8101605</span></span>
<span><span class="co">#&gt; 3  1.51685344  1.61485031  1.6091542</span></span>
<span><span class="co">#&gt; 4  0.18340247 -0.06804704  0.2677832</span></span>
<span><span class="co">#&gt; 5 -0.03322359  0.43998031  0.3998337</span></span>
<span><span class="co">#&gt; 6 -0.80060130 -0.43433496 -1.3110661</span></span>
<span></span>
<span><span class="va">pvs_long1</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">pvs_wide</span>, cols <span class="op">=</span> <span class="fu">all_of</span><span class="op">(</span><span class="va">pvs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pvs_long2</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">pvs_long1</span>, col <span class="op">=</span> <span class="st">"name"</span>, sep <span class="op">=</span> <span class="st">"_"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dimension"</span>, <span class="st">"imp"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pvs_long2</span><span class="op">$</span><span class="va">imp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"pv"</span>, <span class="st">""</span>, <span class="va">pvs_long2</span><span class="op">$</span><span class="va">imp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finale long format</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">pvs_long2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   idstud dimension imp       value</span></span>
<span><span class="co">#&gt; 1      1        ma   1  0.15372011</span></span>
<span><span class="co">#&gt; 2      1        ma   2 -0.04119330</span></span>
<span><span class="co">#&gt; 3      1        ma   3  0.57028949</span></span>
<span><span class="co">#&gt; 4      1        ma   4  0.01687233</span></span>
<span><span class="co">#&gt; 5      1        ma   5  0.30039680</span></span>
<span><span class="co">#&gt; 6      1       rea   1  0.43914365</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="handling-meta-data">Handling meta data<a class="anchor" aria-label="anchor" href="#handling-meta-data"></a>
</h2>
<p>After reshaping we adapt the meta data in our initial
<code>GADSdat</code> object via <code><a href="../reference/updateMeta.html">updateMeta()</a></code>. This is
necessary, as variables have been removed from the data set
(e.g. <code>"ma_pv1"</code> etc.) and new variables have replaced them
(<code>"value"</code>, <code>"dimension"</code>, <code>"imp"</code>).
Now we have to add some variable labels, as most of the old variable
labels got lost due to the reshaping. For an extensive tutorial see the
vignette <a href="import_raw.html">Handling Meta Data</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvs_gads2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/updateMeta.html">updateMeta</a></span><span class="op">(</span><span class="va">pvs_gads</span>, newDat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">pvs_long2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Removing the following rows from meta data: ma_pv1, ma_pv2, ma_pv3, ma_pv4, ma_pv5, rea_pv1, rea_pv2, rea_pv3, rea_pv4, rea_pv5, sci_pv1, sci_pv2, sci_pv3, sci_pv4, sci_pv5</span></span>
<span><span class="co">#&gt; Adding meta data for the following variables: dimension, imp, value</span></span>
<span><span class="fu"><a href="../reference/extractMeta.html">extractMeta</a></span><span class="op">(</span><span class="va">pvs_gads2</span><span class="op">)</span></span>
<span><span class="co">#&gt;             varName   varLabel format display_width labeled value valLabel</span></span>
<span><span class="co">#&gt; 1            idstud Student-ID   F8.0            NA      no    NA     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; dimension dimension       &lt;NA&gt;   &lt;NA&gt;            NA      no    NA     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; imp             imp       &lt;NA&gt;   &lt;NA&gt;            NA      no    NA     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; value         value       &lt;NA&gt;   &lt;NA&gt;            NA      no    NA     &lt;NA&gt;</span></span>
<span><span class="co">#&gt;           missings</span></span>
<span><span class="co">#&gt; 1             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; dimension     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; imp           &lt;NA&gt;</span></span>
<span><span class="co">#&gt; value         &lt;NA&gt;</span></span>
<span></span>
<span><span class="co"># </span></span>
<span><span class="va">pvs_gads2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/changeVarLabels.html">changeVarLabels</a></span><span class="op">(</span><span class="va">pvs_gads2</span>, varName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dimension"</span>, <span class="st">"imp"</span>, <span class="st">"value"</span><span class="op">)</span>,</span>
<span>                varLabel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Achievement dimension (math, reading, science)"</span>,</span>
<span>                             <span class="st">"Number of imputation of plausible values"</span>,</span>
<span>                             <span class="st">"Plausible Value"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extractMeta.html">extractMeta</a></span><span class="op">(</span><span class="va">pvs_gads2</span><span class="op">)</span></span>
<span><span class="co">#&gt;             varName                                       varLabel format</span></span>
<span><span class="co">#&gt; 1            idstud                                     Student-ID   F8.0</span></span>
<span><span class="co">#&gt; dimension dimension Achievement dimension (math, reading, science)   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; imp             imp       Number of imputation of plausible values   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; value         value                                Plausible Value   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;           display_width labeled value valLabel missings</span></span>
<span><span class="co">#&gt; 1                    NA      no    NA     &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; dimension            NA      no    NA     &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; imp                  NA      no    NA     &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; value                NA      no    NA     &lt;NA&gt;     &lt;NA&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preparing-and-creating-the-data-base">Preparing and Creating the data base<a class="anchor" aria-label="anchor" href="#preparing-and-creating-the-data-base"></a>
</h2>
<p>For the creation of a relational data base we recreate the initial
hierarchical structure via <code><a href="../reference/mergeLabels.html">mergeLabels()</a></code> (which performs
the reverse action as <code>extractGADS()</code>). Furthermore, we
create two lists, a primary key list (<code>pkList</code>) and a foreign
key list (<code>fkList</code>). Primary keys are the variables that
uniquely identify each row within every hierarchy level. Foreign keys
are the variables that allow merging between different hierarchy levels.
In the list of foreign keys we also have to specify another hierarchy
level, to which each hierarchy level connects. An exception is the
lowest hierarchy levels, which serves as a basis.</p>
<p>By setting up the order and the foreign keys of the data base we
specify how the data is merged together when we extract data from it. In
contrast to conventional relational data bases, <code>eatGADS</code>
data bases are less flexible: The package does not support modifying the
data base after its creation or extracting data from it with different
merges than specified when it was set up.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merged_gads</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mergeLabels.html">mergeLabels</a></span><span class="op">(</span>noImp <span class="op">=</span> <span class="va">noImp_gads</span>, PVs <span class="op">=</span> <span class="va">pvs_gads2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pkList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>noImp <span class="op">=</span> <span class="st">"idstud"</span>,</span>
<span>               PVs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"idstud"</span>, <span class="st">"imp"</span>, <span class="st">"dimension"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fkList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>noImp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>References <span class="op">=</span> <span class="cn">NULL</span>, Keys <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>               PVs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>References <span class="op">=</span> <span class="st">"noImp"</span>, Keys <span class="op">=</span> <span class="st">"idstud"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we create the relational data base on disc via the
<code><a href="../reference/createGADS.html">createGADS()</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">".db"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/createGADS.html">createGADS</a></span><span class="op">(</span><span class="va">merged_gads</span>, pkList <span class="op">=</span> <span class="va">pkList</span>, fkList <span class="op">=</span> <span class="va">fkList</span>,</span>
<span>           filePath <span class="op">=</span> <span class="va">temp_path</span><span class="op">)</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>For a detailed tutorial on how to use a relational
<code>eatGADS</code> data base see the vignette <a href="getGADS.html"><code>getGADS</code>: Using a relational eatGADS
data base</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benjamin Becker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
